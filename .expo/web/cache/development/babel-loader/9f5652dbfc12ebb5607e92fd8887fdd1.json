{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport invariant from 'invariant';\nimport NativeModules from \"react-native-web/dist/exports/NativeModules\";\nimport Platform from \"react-native-web/dist/exports/Platform\";\nimport base64 from 'react-native-base64';\nvar RNAppAuth = NativeModules.RNAppAuth;\n\nvar validateIssuerOrServiceConfigurationEndpoints = function validateIssuerOrServiceConfigurationEndpoints(issuer, serviceConfiguration) {\n  return invariant(typeof issuer === 'string' || serviceConfiguration && typeof serviceConfiguration.authorizationEndpoint === 'string' && typeof serviceConfiguration.tokenEndpoint === 'string', 'Config error: you must provide either an issuer or a service endpoints');\n};\n\nvar validateIssuerOrServiceConfigurationRegistrationEndpoint = function validateIssuerOrServiceConfigurationRegistrationEndpoint(issuer, serviceConfiguration) {\n  return invariant(typeof issuer === 'string' || serviceConfiguration && typeof serviceConfiguration.registrationEndpoint === 'string', 'Config error: you must provide either an issuer or a registration endpoint');\n};\n\nvar validateIssuerOrServiceConfigurationRevocationEndpoint = function validateIssuerOrServiceConfigurationRevocationEndpoint(issuer, serviceConfiguration) {\n  return invariant(typeof issuer === 'string' || serviceConfiguration && typeof serviceConfiguration.revocationEndpoint === 'string', 'Config error: you must provide either an issuer or a revocation endpoint');\n};\n\nvar validateClientId = function validateClientId(clientId) {\n  return invariant(typeof clientId === 'string', 'Config error: clientId must be a string');\n};\n\nvar validateRedirectUrl = function validateRedirectUrl(redirectUrl) {\n  return invariant(typeof redirectUrl === 'string', 'Config error: redirectUrl must be a string');\n};\n\nvar validateHeaders = function validateHeaders(headers) {\n  if (!headers) {\n    return;\n  }\n\n  var customHeaderTypeErrorMessage = 'Config error: customHeaders type must be { token?: { [key: string]: string }, authorize?: { [key: string]: string }, register: { [key: string]: string }}';\n  var authorizedKeys = ['token', 'authorize', 'register'];\n  var keys = Object.keys(headers);\n  var correctKeys = keys.filter(function (key) {\n    return authorizedKeys.includes(key);\n  });\n  invariant(keys.length <= authorizedKeys.length && correctKeys.length > 0 && correctKeys.length === keys.length, customHeaderTypeErrorMessage);\n  Object.values(headers).forEach(function (value) {\n    invariant(typeof value === 'object', customHeaderTypeErrorMessage);\n    invariant(Object.values(value).filter(function (key) {\n      return typeof key !== 'string';\n    }).length === 0, customHeaderTypeErrorMessage);\n  });\n};\n\nvar validateAdditionalHeaders = function validateAdditionalHeaders(headers) {\n  if (!headers) {\n    return;\n  }\n\n  var errorMessage = 'Config error: additionalHeaders must be { [key: string]: string }';\n  invariant(typeof headers === 'object', errorMessage);\n  invariant(Object.values(headers).filter(function (key) {\n    return typeof key !== 'string';\n  }).length === 0, errorMessage);\n};\n\nexport var prefetchConfiguration = function prefetchConfiguration(_ref) {\n  var warmAndPrefetchChrome, issuer, redirectUrl, clientId, scopes, serviceConfiguration, _ref$dangerouslyAllow, dangerouslyAllowInsecureHttpRequests, customHeaders, nativeMethodArguments;\n\n  return _regeneratorRuntime.async(function prefetchConfiguration$(_context) {\n    while (1) {\n      switch (_context.prev = _context.next) {\n        case 0:\n          warmAndPrefetchChrome = _ref.warmAndPrefetchChrome, issuer = _ref.issuer, redirectUrl = _ref.redirectUrl, clientId = _ref.clientId, scopes = _ref.scopes, serviceConfiguration = _ref.serviceConfiguration, _ref$dangerouslyAllow = _ref.dangerouslyAllowInsecureHttpRequests, dangerouslyAllowInsecureHttpRequests = _ref$dangerouslyAllow === void 0 ? false : _ref$dangerouslyAllow, customHeaders = _ref.customHeaders;\n\n          if (Platform.OS === 'android') {\n            validateIssuerOrServiceConfigurationEndpoints(issuer, serviceConfiguration);\n            validateClientId(clientId);\n            validateRedirectUrl(redirectUrl);\n            validateHeaders(customHeaders);\n            nativeMethodArguments = [warmAndPrefetchChrome, issuer, redirectUrl, clientId, scopes, serviceConfiguration, dangerouslyAllowInsecureHttpRequests, customHeaders];\n            RNAppAuth.prefetchConfiguration.apply(RNAppAuth, nativeMethodArguments);\n          }\n\n        case 2:\n        case \"end\":\n          return _context.stop();\n      }\n    }\n  }, null, null, null, Promise);\n};\nexport var register = function register(_ref2) {\n  var issuer = _ref2.issuer,\n      redirectUrls = _ref2.redirectUrls,\n      responseTypes = _ref2.responseTypes,\n      grantTypes = _ref2.grantTypes,\n      subjectType = _ref2.subjectType,\n      tokenEndpointAuthMethod = _ref2.tokenEndpointAuthMethod,\n      additionalParameters = _ref2.additionalParameters,\n      serviceConfiguration = _ref2.serviceConfiguration,\n      _ref2$dangerouslyAllo = _ref2.dangerouslyAllowInsecureHttpRequests,\n      dangerouslyAllowInsecureHttpRequests = _ref2$dangerouslyAllo === void 0 ? false : _ref2$dangerouslyAllo,\n      customHeaders = _ref2.customHeaders,\n      additionalHeaders = _ref2.additionalHeaders;\n  validateIssuerOrServiceConfigurationRegistrationEndpoint(issuer, serviceConfiguration);\n  validateHeaders(customHeaders);\n  validateAdditionalHeaders(additionalHeaders);\n  invariant(Array.isArray(redirectUrls) && redirectUrls.every(function (url) {\n    return typeof url === 'string';\n  }), 'Config error: redirectUrls must be an Array of strings');\n  invariant(responseTypes == null || Array.isArray(responseTypes) && responseTypes.every(function (rt) {\n    return typeof rt === 'string';\n  }), 'Config error: if provided, responseTypes must be an Array of strings');\n  invariant(grantTypes == null || Array.isArray(grantTypes) && grantTypes.every(function (gt) {\n    return typeof gt === 'string';\n  }), 'Config error: if provided, grantTypes must be an Array of strings');\n  invariant(subjectType == null || typeof subjectType === 'string', 'Config error: if provided, subjectType must be a string');\n  invariant(tokenEndpointAuthMethod == null || typeof tokenEndpointAuthMethod === 'string', 'Config error: if provided, tokenEndpointAuthMethod must be a string');\n  var nativeMethodArguments = [issuer, redirectUrls, responseTypes, grantTypes, subjectType, tokenEndpointAuthMethod, additionalParameters, serviceConfiguration];\n\n  if (Platform.OS === 'android') {\n    nativeMethodArguments.push(dangerouslyAllowInsecureHttpRequests);\n    nativeMethodArguments.push(customHeaders);\n  }\n\n  if (Platform.OS === 'ios') {\n    nativeMethodArguments.push(additionalHeaders);\n  }\n\n  return RNAppAuth.register.apply(RNAppAuth, nativeMethodArguments);\n};\nexport var authorize = function authorize(_ref3) {\n  var issuer = _ref3.issuer,\n      redirectUrl = _ref3.redirectUrl,\n      clientId = _ref3.clientId,\n      clientSecret = _ref3.clientSecret,\n      scopes = _ref3.scopes,\n      _ref3$useNonce = _ref3.useNonce,\n      useNonce = _ref3$useNonce === void 0 ? true : _ref3$useNonce,\n      _ref3$usePKCE = _ref3.usePKCE,\n      usePKCE = _ref3$usePKCE === void 0 ? true : _ref3$usePKCE,\n      additionalParameters = _ref3.additionalParameters,\n      serviceConfiguration = _ref3.serviceConfiguration,\n      _ref3$clientAuthMetho = _ref3.clientAuthMethod,\n      clientAuthMethod = _ref3$clientAuthMetho === void 0 ? 'basic' : _ref3$clientAuthMetho,\n      _ref3$dangerouslyAllo = _ref3.dangerouslyAllowInsecureHttpRequests,\n      dangerouslyAllowInsecureHttpRequests = _ref3$dangerouslyAllo === void 0 ? false : _ref3$dangerouslyAllo,\n      customHeaders = _ref3.customHeaders,\n      additionalHeaders = _ref3.additionalHeaders,\n      _ref3$skipCodeExchang = _ref3.skipCodeExchange,\n      skipCodeExchange = _ref3$skipCodeExchang === void 0 ? false : _ref3$skipCodeExchang;\n  validateIssuerOrServiceConfigurationEndpoints(issuer, serviceConfiguration);\n  validateClientId(clientId);\n  validateRedirectUrl(redirectUrl);\n  validateHeaders(customHeaders);\n  validateAdditionalHeaders(additionalHeaders);\n  var nativeMethodArguments = [issuer, redirectUrl, clientId, clientSecret, scopes, additionalParameters, serviceConfiguration, skipCodeExchange];\n\n  if (Platform.OS === 'android') {\n    nativeMethodArguments.push(usePKCE);\n    nativeMethodArguments.push(clientAuthMethod);\n    nativeMethodArguments.push(dangerouslyAllowInsecureHttpRequests);\n    nativeMethodArguments.push(customHeaders);\n  }\n\n  if (Platform.OS === 'ios') {\n    nativeMethodArguments.push(additionalHeaders);\n    nativeMethodArguments.push(useNonce);\n    nativeMethodArguments.push(usePKCE);\n  }\n\n  return RNAppAuth.authorize.apply(RNAppAuth, nativeMethodArguments);\n};\nexport var refresh = function refresh(_ref4, _ref5) {\n  var issuer = _ref4.issuer,\n      redirectUrl = _ref4.redirectUrl,\n      clientId = _ref4.clientId,\n      clientSecret = _ref4.clientSecret,\n      scopes = _ref4.scopes,\n      additionalParameters = _ref4.additionalParameters,\n      serviceConfiguration = _ref4.serviceConfiguration,\n      _ref4$clientAuthMetho = _ref4.clientAuthMethod,\n      clientAuthMethod = _ref4$clientAuthMetho === void 0 ? 'basic' : _ref4$clientAuthMetho,\n      _ref4$dangerouslyAllo = _ref4.dangerouslyAllowInsecureHttpRequests,\n      dangerouslyAllowInsecureHttpRequests = _ref4$dangerouslyAllo === void 0 ? false : _ref4$dangerouslyAllo,\n      customHeaders = _ref4.customHeaders,\n      additionalHeaders = _ref4.additionalHeaders;\n  var refreshToken = _ref5.refreshToken;\n  validateIssuerOrServiceConfigurationEndpoints(issuer, serviceConfiguration);\n  validateClientId(clientId);\n  validateRedirectUrl(redirectUrl);\n  validateHeaders(customHeaders);\n  validateAdditionalHeaders(additionalHeaders);\n  invariant(refreshToken, 'Please pass in a refresh token');\n  var nativeMethodArguments = [issuer, redirectUrl, clientId, clientSecret, refreshToken, scopes, additionalParameters, serviceConfiguration];\n\n  if (Platform.OS === 'android') {\n    nativeMethodArguments.push(clientAuthMethod);\n    nativeMethodArguments.push(dangerouslyAllowInsecureHttpRequests);\n    nativeMethodArguments.push(customHeaders);\n  }\n\n  if (Platform.OS === 'ios') {\n    nativeMethodArguments.push(additionalHeaders);\n  }\n\n  return RNAppAuth.refresh.apply(RNAppAuth, nativeMethodArguments);\n};\nexport var revoke = function revoke(_ref6, _ref7) {\n  var clientId, issuer, serviceConfiguration, clientSecret, tokenToRevoke, _ref7$sendClientId, sendClientId, _ref7$includeBasicAut, includeBasicAuth, revocationEndpoint, response, openidConfig, headers;\n\n  return _regeneratorRuntime.async(function revoke$(_context2) {\n    while (1) {\n      switch (_context2.prev = _context2.next) {\n        case 0:\n          clientId = _ref6.clientId, issuer = _ref6.issuer, serviceConfiguration = _ref6.serviceConfiguration, clientSecret = _ref6.clientSecret;\n          tokenToRevoke = _ref7.tokenToRevoke, _ref7$sendClientId = _ref7.sendClientId, sendClientId = _ref7$sendClientId === void 0 ? false : _ref7$sendClientId, _ref7$includeBasicAut = _ref7.includeBasicAuth, includeBasicAuth = _ref7$includeBasicAut === void 0 ? false : _ref7$includeBasicAut;\n          invariant(tokenToRevoke, 'Please include the token to revoke');\n          validateClientId(clientId);\n          validateIssuerOrServiceConfigurationRevocationEndpoint(issuer, serviceConfiguration);\n\n          if (!(serviceConfiguration && serviceConfiguration.revocationEndpoint)) {\n            _context2.next = 9;\n            break;\n          }\n\n          revocationEndpoint = serviceConfiguration.revocationEndpoint;\n          _context2.next = 17;\n          break;\n\n        case 9:\n          _context2.next = 11;\n          return _regeneratorRuntime.awrap(fetch(issuer + \"/.well-known/openid-configuration\"));\n\n        case 11:\n          response = _context2.sent;\n          _context2.next = 14;\n          return _regeneratorRuntime.awrap(response.json());\n\n        case 14:\n          openidConfig = _context2.sent;\n          invariant(openidConfig.revocation_endpoint, 'The openid config does not specify a revocation endpoint');\n          revocationEndpoint = openidConfig.revocation_endpoint;\n\n        case 17:\n          headers = {\n            'Content-Type': 'application/x-www-form-urlencoded'\n          };\n\n          if (includeBasicAuth) {\n            headers.Authorization = \"Basic \" + base64.encode(clientId + \":\" + clientSecret);\n          }\n\n          _context2.next = 21;\n          return _regeneratorRuntime.awrap(fetch(revocationEndpoint, {\n            method: 'POST',\n            headers: headers,\n            body: \"token=\" + tokenToRevoke + (sendClientId ? \"&client_id=\" + clientId : '')\n          }).catch(function (error) {\n            throw new Error('Failed to revoke token', error);\n          }));\n\n        case 21:\n          return _context2.abrupt(\"return\", _context2.sent);\n\n        case 22:\n        case \"end\":\n          return _context2.stop();\n      }\n    }\n  }, null, null, null, Promise);\n};","map":{"version":3,"sources":["/Users/niklasmoss/Documents/work/Houe/code/plastic-recycling-app/node_modules/react-native-app-auth/index.js"],"names":["invariant","base64","RNAppAuth","NativeModules","validateIssuerOrServiceConfigurationEndpoints","issuer","serviceConfiguration","authorizationEndpoint","tokenEndpoint","validateIssuerOrServiceConfigurationRegistrationEndpoint","registrationEndpoint","validateIssuerOrServiceConfigurationRevocationEndpoint","revocationEndpoint","validateClientId","clientId","validateRedirectUrl","redirectUrl","validateHeaders","headers","customHeaderTypeErrorMessage","authorizedKeys","keys","Object","correctKeys","filter","key","includes","length","values","forEach","value","validateAdditionalHeaders","errorMessage","prefetchConfiguration","warmAndPrefetchChrome","scopes","dangerouslyAllowInsecureHttpRequests","customHeaders","Platform","OS","nativeMethodArguments","register","redirectUrls","responseTypes","grantTypes","subjectType","tokenEndpointAuthMethod","additionalParameters","additionalHeaders","Array","isArray","every","url","rt","gt","push","authorize","clientSecret","useNonce","usePKCE","clientAuthMethod","skipCodeExchange","refresh","refreshToken","revoke","tokenToRevoke","sendClientId","includeBasicAuth","fetch","response","json","openidConfig","revocation_endpoint","Authorization","encode","method","body","catch","error","Error"],"mappings":"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","sourcesContent":["import invariant from 'invariant';\nimport { NativeModules, Platform } from 'react-native';\nimport base64 from 'react-native-base64';\n\nconst { RNAppAuth } = NativeModules;\n\nconst validateIssuerOrServiceConfigurationEndpoints = (issuer, serviceConfiguration) =>\n  invariant(\n    typeof issuer === 'string' ||\n      (serviceConfiguration &&\n        typeof serviceConfiguration.authorizationEndpoint === 'string' &&\n        typeof serviceConfiguration.tokenEndpoint === 'string'),\n    'Config error: you must provide either an issuer or a service endpoints'\n  );\nconst validateIssuerOrServiceConfigurationRegistrationEndpoint = (issuer, serviceConfiguration) =>\n  invariant(\n    typeof issuer === 'string' ||\n      (serviceConfiguration && typeof serviceConfiguration.registrationEndpoint === 'string'),\n    'Config error: you must provide either an issuer or a registration endpoint'\n  );\nconst validateIssuerOrServiceConfigurationRevocationEndpoint = (issuer, serviceConfiguration) =>\n  invariant(\n    typeof issuer === 'string' ||\n      (serviceConfiguration && typeof serviceConfiguration.revocationEndpoint === 'string'),\n    'Config error: you must provide either an issuer or a revocation endpoint'\n  );\nconst validateClientId = clientId =>\n  invariant(typeof clientId === 'string', 'Config error: clientId must be a string');\nconst validateRedirectUrl = redirectUrl =>\n  invariant(typeof redirectUrl === 'string', 'Config error: redirectUrl must be a string');\n\nconst validateHeaders = headers => {\n  if (!headers) {\n    return;\n  }\n  const customHeaderTypeErrorMessage =\n    'Config error: customHeaders type must be { token?: { [key: string]: string }, authorize?: { [key: string]: string }, register: { [key: string]: string }}';\n\n  const authorizedKeys = ['token', 'authorize', 'register'];\n  const keys = Object.keys(headers);\n  const correctKeys = keys.filter(key => authorizedKeys.includes(key));\n  invariant(\n    keys.length <= authorizedKeys.length &&\n      correctKeys.length > 0 &&\n      correctKeys.length === keys.length,\n    customHeaderTypeErrorMessage\n  );\n\n  Object.values(headers).forEach(value => {\n    invariant(typeof value === 'object', customHeaderTypeErrorMessage);\n    invariant(\n      Object.values(value).filter(key => typeof key !== 'string').length === 0,\n      customHeaderTypeErrorMessage\n    );\n  });\n};\n\nconst validateAdditionalHeaders = headers => {\n  if (!headers) {\n    return;\n  }\n\n  const errorMessage = 'Config error: additionalHeaders must be { [key: string]: string }';\n\n  invariant(typeof headers === 'object', errorMessage);\n  invariant(\n    Object.values(headers).filter(key => typeof key !== 'string').length === 0,\n    errorMessage\n  );\n};\n\nexport const prefetchConfiguration = async ({\n  warmAndPrefetchChrome,\n  issuer,\n  redirectUrl,\n  clientId,\n  scopes,\n  serviceConfiguration,\n  dangerouslyAllowInsecureHttpRequests = false,\n  customHeaders,\n}) => {\n  if (Platform.OS === 'android') {\n    validateIssuerOrServiceConfigurationEndpoints(issuer, serviceConfiguration);\n    validateClientId(clientId);\n    validateRedirectUrl(redirectUrl);\n    validateHeaders(customHeaders);\n\n    const nativeMethodArguments = [\n      warmAndPrefetchChrome,\n      issuer,\n      redirectUrl,\n      clientId,\n      scopes,\n      serviceConfiguration,\n      dangerouslyAllowInsecureHttpRequests,\n      customHeaders,\n    ];\n\n    RNAppAuth.prefetchConfiguration(...nativeMethodArguments);\n  }\n};\n\nexport const register = ({\n  issuer,\n  redirectUrls,\n  responseTypes,\n  grantTypes,\n  subjectType,\n  tokenEndpointAuthMethod,\n  additionalParameters,\n  serviceConfiguration,\n  dangerouslyAllowInsecureHttpRequests = false,\n  customHeaders,\n  additionalHeaders,\n}) => {\n  validateIssuerOrServiceConfigurationRegistrationEndpoint(issuer, serviceConfiguration);\n  validateHeaders(customHeaders);\n  validateAdditionalHeaders(additionalHeaders);\n\n  invariant(\n    Array.isArray(redirectUrls) && redirectUrls.every(url => typeof url === 'string'),\n    'Config error: redirectUrls must be an Array of strings'\n  );\n  invariant(\n    responseTypes == null ||\n      (Array.isArray(responseTypes) && responseTypes.every(rt => typeof rt === 'string')),\n    'Config error: if provided, responseTypes must be an Array of strings'\n  );\n  invariant(\n    grantTypes == null ||\n      (Array.isArray(grantTypes) && grantTypes.every(gt => typeof gt === 'string')),\n    'Config error: if provided, grantTypes must be an Array of strings'\n  );\n  invariant(\n    subjectType == null || typeof subjectType === 'string',\n    'Config error: if provided, subjectType must be a string'\n  );\n  invariant(\n    tokenEndpointAuthMethod == null || typeof tokenEndpointAuthMethod === 'string',\n    'Config error: if provided, tokenEndpointAuthMethod must be a string'\n  );\n\n  const nativeMethodArguments = [\n    issuer,\n    redirectUrls,\n    responseTypes,\n    grantTypes,\n    subjectType,\n    tokenEndpointAuthMethod,\n    additionalParameters,\n    serviceConfiguration,\n  ];\n\n  if (Platform.OS === 'android') {\n    nativeMethodArguments.push(dangerouslyAllowInsecureHttpRequests);\n    nativeMethodArguments.push(customHeaders);\n  }\n\n  if (Platform.OS === 'ios') {\n    nativeMethodArguments.push(additionalHeaders);\n  }\n\n  return RNAppAuth.register(...nativeMethodArguments);\n};\n\nexport const authorize = ({\n  issuer,\n  redirectUrl,\n  clientId,\n  clientSecret,\n  scopes,\n  useNonce = true,\n  usePKCE = true,\n  additionalParameters,\n  serviceConfiguration,\n  clientAuthMethod = 'basic',\n  dangerouslyAllowInsecureHttpRequests = false,\n  customHeaders,\n  additionalHeaders,\n  skipCodeExchange = false,\n}) => {\n  validateIssuerOrServiceConfigurationEndpoints(issuer, serviceConfiguration);\n  validateClientId(clientId);\n  validateRedirectUrl(redirectUrl);\n  validateHeaders(customHeaders);\n  validateAdditionalHeaders(additionalHeaders);\n  // TODO: validateAdditionalParameters\n\n  const nativeMethodArguments = [\n    issuer,\n    redirectUrl,\n    clientId,\n    clientSecret,\n    scopes,\n    additionalParameters,\n    serviceConfiguration,\n    skipCodeExchange,\n  ];\n\n  if (Platform.OS === 'android') {\n    nativeMethodArguments.push(usePKCE);\n    nativeMethodArguments.push(clientAuthMethod);\n    nativeMethodArguments.push(dangerouslyAllowInsecureHttpRequests);\n    nativeMethodArguments.push(customHeaders);\n  }\n\n  if (Platform.OS === 'ios') {\n    nativeMethodArguments.push(additionalHeaders);\n    nativeMethodArguments.push(useNonce);\n    nativeMethodArguments.push(usePKCE);\n  }\n\n  return RNAppAuth.authorize(...nativeMethodArguments);\n};\n\nexport const refresh = (\n  {\n    issuer,\n    redirectUrl,\n    clientId,\n    clientSecret,\n    scopes,\n    additionalParameters,\n    serviceConfiguration,\n    clientAuthMethod = 'basic',\n    dangerouslyAllowInsecureHttpRequests = false,\n    customHeaders,\n    additionalHeaders,\n  },\n  { refreshToken }\n) => {\n  validateIssuerOrServiceConfigurationEndpoints(issuer, serviceConfiguration);\n  validateClientId(clientId);\n  validateRedirectUrl(redirectUrl);\n  validateHeaders(customHeaders);\n  validateAdditionalHeaders(additionalHeaders);\n  invariant(refreshToken, 'Please pass in a refresh token');\n  // TODO: validateAdditionalParameters\n\n  const nativeMethodArguments = [\n    issuer,\n    redirectUrl,\n    clientId,\n    clientSecret,\n    refreshToken,\n    scopes,\n    additionalParameters,\n    serviceConfiguration,\n  ];\n\n  if (Platform.OS === 'android') {\n    nativeMethodArguments.push(clientAuthMethod);\n    nativeMethodArguments.push(dangerouslyAllowInsecureHttpRequests);\n    nativeMethodArguments.push(customHeaders);\n  }\n\n  if (Platform.OS === 'ios') {\n    nativeMethodArguments.push(additionalHeaders);\n  }\n\n  return RNAppAuth.refresh(...nativeMethodArguments);\n};\n\nexport const revoke = async (\n  { clientId, issuer, serviceConfiguration, clientSecret },\n  { tokenToRevoke, sendClientId = false, includeBasicAuth = false }\n) => {\n  invariant(tokenToRevoke, 'Please include the token to revoke');\n  validateClientId(clientId);\n  validateIssuerOrServiceConfigurationRevocationEndpoint(issuer, serviceConfiguration);\n\n  let revocationEndpoint;\n  if (serviceConfiguration && serviceConfiguration.revocationEndpoint) {\n    revocationEndpoint = serviceConfiguration.revocationEndpoint;\n  } else {\n    const response = await fetch(`${issuer}/.well-known/openid-configuration`);\n    const openidConfig = await response.json();\n\n    invariant(\n      openidConfig.revocation_endpoint,\n      'The openid config does not specify a revocation endpoint'\n    );\n\n    revocationEndpoint = openidConfig.revocation_endpoint;\n  }\n\n  const headers = {\n    'Content-Type': 'application/x-www-form-urlencoded',\n  };\n  if (includeBasicAuth) {\n    headers.Authorization = `Basic ${base64.encode(`${clientId}:${clientSecret}`)}`;\n  }\n  /**\n    Identity Server insists on client_id being passed in the body,\n    but Google does not. According to the spec, Google is right\n    so defaulting to no client_id\n    https://tools.ietf.org/html/rfc7009#section-2.1\n  **/\n  return await fetch(revocationEndpoint, {\n    method: 'POST',\n    headers,\n    body: `token=${tokenToRevoke}${sendClientId ? `&client_id=${clientId}` : ''}`,\n  }).catch(error => {\n    throw new Error('Failed to revoke token', error);\n  });\n};\n"]},"metadata":{},"sourceType":"module"}