import { AuthenticationProvider } from "@microsoft/microsoft-graph-client";
import { DefaultAzureCredential } from "@azure/identity";

class CustomAuthenticationProvider implements AuthenticationProvider {
  private azureCredential: DefaultAzureCredential;

  constructor() {
    this.azureCredential = new DefaultAzureCredential();
  }

  getAccessToken = async () => {
    return "eyJ0eXAiOiJKV1QiLCJub25jZSI6IkwtRE4wRVc4eXg5dzNHZ1lQcWlERXhoTXkwaWlSS2s1UEo2aWQ2aTZpb2siLCJhbGciOiJSUzI1NiIsIng1dCI6Im5PbzNaRHJPRFhFSzFqS1doWHNsSFJfS1hFZyIsImtpZCI6Im5PbzNaRHJPRFhFSzFqS1doWHNsSFJfS1hFZyJ9.eyJhdWQiOiJodHRwczovL2dyYXBoLm1pY3Jvc29mdC5jb20vIiwiaXNzIjoiaHR0cHM6Ly9zdHMud2luZG93cy5uZXQvMTJjYTk5NGYtZDk4Ny00MmUxLThlZjItMjdmOWM5MjJkMTQ1LyIsImlhdCI6MTYyMDc5ODA4MSwibmJmIjoxNjIwNzk4MDgxLCJleHAiOjE2MjA4MDE5ODEsImFjY3QiOjAsImFjciI6IjEiLCJhY3JzIjpbInVybjp1c2VyOnJlZ2lzdGVyc2VjdXJpdHlpbmZvIiwidXJuOm1pY3Jvc29mdDpyZXExIiwidXJuOm1pY3Jvc29mdDpyZXEyIiwidXJuOm1pY3Jvc29mdDpyZXEzIiwiYzEiLCJjMiIsImMzIiwiYzQiLCJjNSIsImM2IiwiYzciLCJjOCIsImM5IiwiYzEwIiwiYzExIiwiYzEyIiwiYzEzIiwiYzE0IiwiYzE1IiwiYzE2IiwiYzE3IiwiYzE4IiwiYzE5IiwiYzIwIiwiYzIxIiwiYzIyIiwiYzIzIiwiYzI0IiwiYzI1Il0sImFpbyI6IkFWUUFxLzhUQUFBQUdwOEYvMnNub2I2RmxiZXRobGxzZHM2aXNYTklzL3N6MXRvdXNHRFY3TW1xTTJ2U05uVW9XSHpqQlF2dlJrS2pZL0RrM0dLeXdTZnhiV3E1SFVJK1NBNENHLzhDSDhEZEpRekc0ekh3Yk4wPSIsImFsdHNlY2lkIjoiMTpsaXZlLmNvbTowMDAzMDAwMEQwNzNENzE4IiwiYW1yIjpbInB3ZCIsIm1mYSJdLCJhcHBfZGlzcGxheW5hbWUiOiJNaWNyb3NvZnQgQXp1cmUgQ0xJIiwiYXBwaWQiOiIwNGIwNzc5NS04ZGRiLTQ2MWEtYmJlZS0wMmY5ZTFiZjdiNDYiLCJhcHBpZGFjciI6IjAiLCJlbWFpbCI6Im5pa2xhcy5ub2VycmVnYWFyZEBnbWFpbC5jb20iLCJmYW1pbHlfbmFtZSI6Ik1vc3MiLCJnaXZlbl9uYW1lIjoiTmlrbGFzIiwiaWRwIjoibGl2ZS5jb20iLCJpZHR5cCI6InVzZXIiLCJpcGFkZHIiOiIyMTMuMzIuMjQyLjIwNyIsIm5hbWUiOiJOaWtsYXMgTW9zcyIsIm9pZCI6ImY0NGRlNWE1LWVmOTQtNGU1MC1iMjMyLTM5NzcwZWYzNWFiZiIsInBsYXRmIjoiNSIsInB1aWQiOiIxMDAzMjAwMTM5NjdGMkI3IiwicmgiOiIwLkFTSUFUNW5LRW9mWjRVS084aWY1eVNMUlJaVjNzQVRialJwR3UtNEMtZUdfZTBZeUFGby4iLCJzY3AiOiJBdWRpdExvZy5SZWFkLkFsbCBEaXJlY3RvcnkuQWNjZXNzQXNVc2VyLkFsbCBHcm91cC5SZWFkV3JpdGUuQWxsIFVzZXIuUmVhZFdyaXRlLkFsbCIsInN1YiI6Ik1sWnRMM0RmcjJDdkkzX2VHOTZkMWRTeGdCUUJuRG52amZBNFl1RERlUmsiLCJ0ZW5hbnRfcmVnaW9uX3Njb3BlIjoiRVUiLCJ0aWQiOiIxMmNhOTk0Zi1kOTg3LTQyZTEtOGVmMi0yN2Y5YzkyMmQxNDUiLCJ1bmlxdWVfbmFtZSI6ImxpdmUuY29tI25pa2xhcy5ub2VycmVnYWFyZEBnbWFpbC5jb20iLCJ1dGkiOiJIR2J4SncwRWpFeUN0NHJwbm91VkFBIiwidmVyIjoiMS4wIiwid2lkcyI6WyI2MmU5MDM5NC02OWY1LTQyMzctOTE5MC0wMTIxNzcxNDVlMTAiLCJiNzlmYmY0ZC0zZWY5LTQ2ODktODE0My03NmIxOTRlODU1MDkiXSwieG1zX3RjZHQiOjE2MTk4ODc3MTB9.Dr_ekFAaSLm2fE37dFb0gnPDnVnp5b31-asE1g70Y7Kn7tIyceq81V58li6cP6wjtjGIcE2u6zziqAYb3u-812pA-UnY7-bxAmUjEC12oijSiPiuwMbhC1pIvTh9TFliqq7_uBHU-xXTnFW25v3OVjHKP-p8ueMSV46EZQgJvNW6Cn812uxgg-JUvk_0W6VzpA6QXlZKRInfjjcAADtIah736claNc26GfNEDb0dWBkVYdUkSTUrMINGwahJvmjvfEYMSl59QEIKoMK9kGLEvrWo3b2aDR96cyfnLAtjVIxXHEcXkTPiOb2aE4wIKMfezuFbGVOeGNeY3wuY0T7yFA";
    /*
    const accessToken = await this.azureCredential.getToken([
      "User.ReadWrite.All",
    ]);

    return accessToken.token;
    */
  };
}

export default CustomAuthenticationProvider;
